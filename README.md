# yc-finops-python

Для работы функции необходимо:

1.  Создать бакет
2.  В резделе биллинга облачной консоли настроить периодическую выгрузку данных в созданный бакет
3.  Создать сервисную учетную запись с правами на чтение/запись в бакет, а также права на создание новых бакетов
4.  Для сервисной учетной записи создать ключ AWS
5.  Создать секрет Lockbox (запросить доступ к preview сервиса, если его нет) в котором прописать AWS\_ACCESS\_KEY\_ID (id ключа), AWS\_SECRET\_ACCESS\_KEY (секретный ключ) и AWS\_DEFAULT\_REGION = ru-central1
6.  Создать функцию
7.  В качестве триггера функции указать S3 - создание объекта в бакете созданном в п. 1
8.  Настроить доступ к секретам Lockbox созданному в п. 5 из функции с именами, соответствующими перечисленным в п. 5
9. Создать файл-словарь и разместить его в объектном хранилище. Словарь должен быть формата CSV с заголовками: "clusterId,label.user_labels.<label1>,label.user_labels.<lfbel2>[..label.user_labels.<lfbel2>]", добавив необходимое количество лейблов с префиксом "label.user_labels." через запятую. 
Далее в каждой последующей строке задать ID существующих кластеров Greenplum и соответствующие им лейблы.

To-Do:
1. Реализовать цикл обработки на основе количества строк в файле-словаре
2. Вынести название бакета и имя файла-словаря в переменные окружения
3. Реализовать перезаписывание файла-выгрузки биллинга без потворного исполнения кода по расширению данных по словарю
